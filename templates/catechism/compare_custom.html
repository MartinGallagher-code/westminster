{% extends "base.html" %}

{% block body_attrs %}data-filter-sensitive="true"{% endblock %}
{% block title %}Custom Comparison - Study Reformed{% endblock %}

{% block content %}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'catechism:home' %}">Home</a></li>
        <li class="breadcrumb-item"><a href="{% url 'catechism:compare_index' %}">Compare</a></li>
        <li class="breadcrumb-item active">Custom Comparison</li>
    </ol>
</nav>

<h1 class="mb-2">Custom Comparison</h1>

{# Document pills showing current selection #}
<div class="mb-4">
    {% for cat in selected_catechisms %}
    <span class="badge bg-secondary me-1">{{ cat.abbreviation }}</span>
    {% endfor %}
    <a href="{% url 'catechism:compare_index' %}" class="btn btn-outline-secondary btn-sm ms-2">
        <i class="bi bi-pencil me-1"></i>Change Selection
    </a>
</div>

{% if error %}
<div class="alert alert-warning">{{ error }}</div>
{% endif %}

{% if themes %}
{% regroup themes by locus as locus_groups %}
{% for group in locus_groups %}
{% if group.grouper %}
<h4 class="mt-4 mb-3">{{ group.grouper }}</h4>
{% endif %}
<div class="list-group mb-3">
    {% for item in group.list %}
    <a href="{% url 'catechism:compare_custom_theme' theme_slug=item.theme.slug %}?docs={{ docs_param }}"
       class="list-group-item list-group-item-action">
        <h5 class="mb-1">{{ item.theme.name }}</h5>
        {% if item.theme.description %}
        <p class="mb-0 text-muted small">{{ item.theme.description }}</p>
        {% endif %}
    </a>
    {% endfor %}
</div>
{% endfor %}
{% elif not error %}
<p class="text-muted">No themes found that cover at least two of your selected documents.</p>
{% endif %}
{% endblock %}
