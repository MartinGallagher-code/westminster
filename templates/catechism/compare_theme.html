{% extends "base.html" %}

{% block title %}{{ theme.name }} - {{ comparison_set.name }}{% endblock %}
{% block meta_description %}Compare what the Westminster Confession, Shorter Catechism, and Larger Catechism teach about {{ theme.name }}.{% endblock %}
{% block og_title %}{{ theme.name }} - Compare the Westminster Standards{% endblock %}
{% block og_description %}See how the Westminster Confession, Shorter Catechism, and Larger Catechism treat {{ theme.name }}.{% endblock %}

{% block content %}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'catechism:home' %}">Home</a></li>
        <li class="breadcrumb-item"><a href="{% url 'catechism:compare_index' %}">Compare</a></li>
        <li class="breadcrumb-item"><a href="{% url 'catechism:compare_set' set_slug=comparison_set.slug %}">{{ comparison_set.name }}</a></li>
        <li class="breadcrumb-item active">{{ theme.name }}</li>
    </ol>
</nav>

<!-- Prev/Next theme navigation -->
<div class="d-flex justify-content-between mb-3">
    {% if previous_theme %}
    <a href="{{ previous_theme.get_absolute_url }}" class="btn btn-outline-secondary btn-sm">
        <i class="bi bi-chevron-left me-1"></i>{{ previous_theme.name|truncatewords:5 }}
    </a>
    {% else %}<span></span>{% endif %}
    {% if next_theme %}
    <a href="{{ next_theme.get_absolute_url }}" class="btn btn-outline-secondary btn-sm">
        {{ next_theme.name|truncatewords:5 }}<i class="bi bi-chevron-right ms-1"></i>
    </a>
    {% else %}<span></span>{% endif %}
</div>

<h1 class="mb-2">{{ theme.name }}</h1>
{% if theme.description %}
<p class="text-muted mb-4">{{ theme.description }}</p>
{% endif %}

{% with col_count=columns|length %}
<div class="row">
    {% for col in columns %}
    <div class="{% if col_count == 1 %}col-lg-12{% elif col_count == 2 %}col-lg-6{% else %}col-lg-4{% endif %} mb-4">
        <div class="card h-100">
            <div class="card-header">
                <strong>{{ col.catechism.abbreviation }}</strong>
                <small class="text-muted ms-1">
                    {{ col.catechism.item_prefix }}{{ col.display_start }}{% if col.question_start != col.question_end %}&ndash;{{ col.display_end }}{% endif %}
                </small>
            </div>
            <div class="list-group list-group-flush">
                {% for q in col.questions %}
                <a href="{{ q.get_absolute_url }}" class="list-group-item list-group-item-action">
                    {% if col.catechism.is_confession %}
                    <p class="mb-1 small"><strong>{{ q.question_text }}</strong></p>
                    <p class="mb-0 text-muted small">{{ q.answer_text }}</p>
                    {% else %}
                    <p class="mb-1 small"><strong>Q{{ q.number }}.</strong> {{ q.question_text }}</p>
                    <p class="mb-0 text-muted small"><strong>A.</strong> {{ q.answer_text }}</p>
                    {% endif %}
                </a>
                {% endfor %}
            </div>
        </div>
    </div>
    {% empty %}
    <p class="text-muted">No entries for this theme.</p>
    {% endfor %}
</div>
{% endwith %}

<!-- Prev/Next (bottom) -->
<div class="d-flex justify-content-between mt-3 mb-4">
    {% if previous_theme %}
    <a href="{{ previous_theme.get_absolute_url }}" class="btn btn-outline-secondary">
        <i class="bi bi-chevron-left me-1"></i>{{ previous_theme.name|truncatewords:5 }}
    </a>
    {% else %}<span></span>{% endif %}
    {% if next_theme %}
    <a href="{{ next_theme.get_absolute_url }}" class="btn btn-outline-secondary">
        {{ next_theme.name|truncatewords:5 }}<i class="bi bi-chevron-right ms-1"></i>
    </a>
    {% else %}<span></span>{% endif %}
</div>
{% endblock %}
