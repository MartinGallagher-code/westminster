{% extends "base.html" %}
{% load static %}

{% block body_attrs %}data-filter-sensitive="true"{% endblock %}
{% block title %}Compare the Standards - Study Reformed{% endblock %}

{% block content %}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'catechism:home' %}">Home</a></li>
        <li class="breadcrumb-item active">Compare</li>
    </ol>
</nav>

<h1 class="mb-3">Compare the Standards</h1>
<p class="text-muted mb-4">Explore doctrinal themes side-by-side across the great Reformed confessional documents, organized by the loci of systematic theology.</p>

{# ── Custom Document Selector ── #}
<div class="card mb-5">
    <div class="card-header">
        <h5 class="mb-0"><i class="bi bi-sliders me-2"></i>Custom Comparison</h5>
    </div>
    <div class="card-body">
        <p class="text-muted small mb-3">Select two or more documents to find shared doctrinal themes.</p>

        {# Preset quick-select buttons #}
        <div class="mb-3">
            <span class="text-muted small me-2">Quick select:</span>
            {% for cs in comparison_sets %}
            <button type="button" class="btn btn-outline-secondary btn-sm me-1 mb-1 preset-btn"
                    data-preset="{{ cs.slug }}">
                {{ cs.name }}
            </button>
            {% endfor %}
            <button type="button" class="btn btn-outline-secondary btn-sm me-1 mb-1" id="select-all-btn">All</button>
            <button type="button" class="btn btn-outline-secondary btn-sm mb-1" id="clear-all-btn">Clear</button>
        </div>

        {# Document checkboxes #}
        <div class="row" id="doc-selector">
            {% for cat in all_catechisms %}
            <div class="col-md-4 col-lg-3 mb-2">
                <div class="form-check">
                    <input class="form-check-input doc-checkbox" type="checkbox"
                           value="{{ cat.slug }}" id="doc-{{ cat.slug }}">
                    <label class="form-check-label" for="doc-{{ cat.slug }}">
                        <strong>{{ cat.abbreviation }}</strong>
                        <small class="text-muted">{{ cat.name }}</small>
                    </label>
                </div>
            </div>
            {% endfor %}
        </div>

        <div class="mt-3 d-flex align-items-center">
            <a href="#" class="btn btn-primary disabled" id="compare-btn" aria-disabled="true">
                <i class="bi bi-layout-split me-1"></i>Compare Selected
            </a>
            <span class="text-muted small ms-3" id="selection-count">Select at least 2 documents</span>
        </div>
    </div>
</div>

{# ── Existing Preset Cards ── #}
<h4 class="mb-3">Curated Comparison Sets</h4>
<div class="row">
    {% for cs in comparison_sets %}
    <div class="col-md-6 col-lg-3 mb-4">
        <div class="card h-100">
            <div class="card-body">
                <h5 class="card-title">{{ cs.name }}</h5>
                <p class="card-text text-muted small">{{ cs.description }}</p>
            </div>
            <div class="card-footer">
                <a href="{{ cs.get_absolute_url }}" class="btn btn-outline-primary btn-sm">View Comparison</a>
            </div>
        </div>
    </div>
    {% empty %}
    <p class="text-muted">No comparison sets available yet.</p>
    {% endfor %}
</div>
{% endblock %}

{% block extra_js %}
<script>
window.PRESET_MAP = {{ preset_map_json|safe }};
</script>
<script src="{% static 'js/compare.js' %}"></script>
{% endblock %}
