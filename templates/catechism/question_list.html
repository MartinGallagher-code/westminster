{% extends "base.html" %}

{% block title %}All {{ catechism.item_name_plural }} - {{ catechism.name }}{% endblock %}

{% block content %}
<h1 class="mb-3">{{ catechism.abbreviation }} &mdash; All {{ catechism.item_name_plural }}</h1>

<nav class="mb-4 topic-jump-nav" aria-label="{{ catechism.topic_name }} navigation">
    <div class="d-flex flex-wrap gap-1 align-items-center">
        <span class="text-body-secondary small fw-semibold me-1">Jump to:</span>
        {% for group in grouped %}
        <a href="#{{ group.topic.slug }}" class="badge text-decoration-none bg-body-secondary text-body-emphasis topic-jump-link">
            {% if catechism.is_confession %}Ch. {{ group.topic.order }}{% else %}{{ group.topic.name|truncatewords:4 }}{% endif %}
        </a>
        {% endfor %}
    </div>
</nav>

<div class="accordion" id="topic-accordion">
{% for group in grouped %}
<div class="accordion-item" id="{{ group.topic.slug }}">
    <h2 class="accordion-header">
        <button class="accordion-button collapsed" type="button"
                data-bs-toggle="collapse" data-bs-target="#collapse-{{ group.topic.slug }}"
                aria-expanded="false" aria-controls="collapse-{{ group.topic.slug }}">
            <span class="me-auto">
                {% if catechism.is_confession %}
                Chapter {{ group.topic.order }}: {{ group.topic.name }}
                {% else %}
                {{ group.topic.name }}
                {% endif %}
            </span>
            <span class="badge bg-body-secondary text-body-emphasis ms-2 me-2">
                {{ group.questions|length }}
            </span>
        </button>
    </h2>
    <div id="collapse-{{ group.topic.slug }}" class="accordion-collapse collapse"
         data-bs-parent="#topic-accordion">
        <div class="accordion-body pt-2 pb-3">
            {% if group.topic.description %}
            <p class="text-body-secondary small mb-2">{{ group.topic.description }}</p>
            {% endif %}
            <div class="d-flex justify-content-end mb-2">
                <a href="{{ group.topic.get_absolute_url }}" class="text-body-secondary small text-decoration-none text-nowrap">
                    {{ catechism.item_name_plural }} {{ group.topic.display_start }}&ndash;{{ group.topic.display_end }}
                </a>
            </div>
            <div class="list-group list-group-flush">
                {% for q in group.questions %}
                <a href="{{ q.get_absolute_url }}" class="list-group-item list-group-item-action py-2 px-0 border-0">
                    {% if catechism.is_confession %}
                    <span class="text-body-secondary me-2">&sect;{{ q.display_number }}</span>
                    {{ q.answer_text|truncatewords:20 }}
                    {% else %}
                    <span class="fw-semibold me-1">Q{{ q.number }}.</span>
                    {{ q.question_text|truncatewords:20 }}
                    {% endif %}
                </a>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% empty %}
<p class="text-muted">No comparison themes available yet.</p>
{% endfor %}
</div>

<div class="text-center mt-3 mb-4">
    <a href="#" class="text-body-secondary small">&uarr; Back to top</a>
</div>
{% endblock %}
